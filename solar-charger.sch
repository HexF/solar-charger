v 20110115 2
C 56200 38000 1 0 0 stm32l151c6.sym
{
T 62500 43700 5 10 1 1 0 6 1
refdes=U?
T 59400 41200 5 10 0 0 0 0 1
device=AD5L79Lxx
T 59400 41400 5 10 0 0 0 0 1
footprint=SOT89
}
C 54400 50900 1 180 0 connector2-2.sym
{
T 53700 49600 5 10 1 1 180 6 1
refdes=IN
T 54100 49650 5 10 0 0 180 0 1
device=CONNECTOR_2
T 54100 49450 5 10 0 0 180 0 1
footprint=SIP2N
}
C 54700 50000 1 90 0 gnd-1.sym
C 56000 40500 1 270 0 gnd-1.sym
C 63200 42900 1 90 1 gnd-1.sym
C 57700 44200 1 180 1 gnd-1.sym
C 69700 46800 1 270 0 resistor-1.sym
{
T 70100 46500 5 10 0 0 270 0 1
device=RESISTOR
T 70000 46800 5 10 1 1 270 0 1
refdes=RSENSE
T 69700 46800 5 10 0 0 270 0 1
footprint=0603
}
C 67600 50400 1 0 0 vcc-1.sym
C 69300 49500 1 0 0 pmos-3.sym
{
T 69900 50000 5 10 0 0 0 0 1
device=PMOS_TRANSISTOR
T 70100 50000 5 10 1 1 90 0 1
refdes=Q?
}
C 64100 49200 1 0 0 gnd-1.sym
C 61300 50200 1 0 0 3.3V-plus-1.sym
C 59200 49000 1 0 0 tps71501.sym
{
T 61000 50700 5 10 1 1 0 6 1
refdes=U?
T 59800 50900 5 10 0 0 0 0 1
device=TPS71501
T 59800 51100 5 10 0 0 0 0 1
footprint=SOT89
T 60100 50000 5 10 1 1 0 0 1
value=3.3V
}
N 61300 50200 61500 50200 4
C 60200 48800 1 0 0 gnd-1.sym
N 69800 49500 69800 49400 4
C 66700 48500 1 0 0 ucc27518.sym
{
T 68500 50200 5 10 1 1 0 6 1
refdes=U?
T 67600 49700 5 10 0 0 0 0 1
device=UCC27518
T 67600 49900 5 10 0 0 0 0 1
footprint=SOT89
}
N 68800 49700 69300 49700 4
C 67700 48300 1 0 0 gnd-1.sym
C 69900 48500 1 90 0 inductor-1.sym
{
T 69400 48700 5 10 0 0 90 0 1
device=INDUCTOR
T 69600 48700 5 10 1 1 90 0 1
refdes=L?
T 69200 48700 5 10 0 0 90 0 1
symversion=0.1
}
C 69700 45600 1 0 0 gnd-1.sym
C 71500 47600 1 0 1 connector2-1.sym
{
T 71300 48600 5 10 0 0 0 6 1
device=CONNECTOR_2
T 71500 48400 5 10 1 1 0 6 1
refdes=BATT
}
N 69800 48100 69800 48500 4
N 69800 46800 69800 47800 4
T 55100 49700 9 10 1 0 0 0 3
Supply from panel:
 * +18V
 * 2W
T 70400 49100 9 10 1 0 0 0 7
Batteries:
 * 6 NiMH (1.45V each charged)
 * 9V in series
 * Capacity: 1100mA h to 2800mA h
 * Limit charge time to 10 h
 * Charge rate: C / 10 = 100mA
 * Trickle rate: C / 300
C 68500 40200 1 0 0 pmos-3.sym
{
T 69100 40700 5 10 0 0 0 0 1
device=PMOS_TRANSISTOR
T 68900 40900 5 10 1 1 90 0 1
refdes=Q?
}
N 69000 40200 69600 40200 4
C 66300 39200 1 0 0 ucc27518.sym
{
T 68100 40900 5 10 1 1 0 6 1
refdes=U?
T 67200 40400 5 10 0 0 0 0 1
device=UCC27518
T 67200 40600 5 10 0 0 0 0 1
footprint=SOT89
}
N 68400 40400 68500 40400 4
C 67300 39000 1 0 0 gnd-1.sym
C 69400 39300 1 90 0 inductor-1.sym
{
T 68900 39500 5 10 0 0 90 0 1
device=INDUCTOR
T 69100 39500 5 10 1 1 90 0 1
refdes=L?
T 68700 39500 5 10 0 0 90 0 1
symversion=0.1
}
C 69200 37300 1 0 0 gnd-1.sym
C 71000 37400 1 0 1 connector2-1.sym
{
T 70800 38400 5 10 0 0 0 6 1
device=CONNECTOR_2
T 70700 39200 5 10 1 1 0 6 1
refdes=OUT
}
N 69300 37900 69300 39300 4
N 66400 40000 65900 40000 4
{
T 65800 40000 5 10 1 1 0 6 1
netname=CH2_PANEL_IN
}
N 66400 40400 65900 40400 4
{
T 65800 40400 5 10 1 1 0 6 1
netname=CH2_PANEL_EN
}
N 66800 49300 66300 49300 4
{
T 66200 49300 5 10 1 1 0 0 1
netname=CH1_IN
}
N 66800 49700 66300 49700 4
{
T 66200 49700 5 10 1 1 0 0 1
netname=CH1_EN
}
C 52200 34200 0 0 0 title-C.sym
C 71500 46500 1 0 0 opamp-1.sym
{
T 72200 47300 5 10 0 0 0 0 1
device=OPAMP
T 72200 47100 5 10 1 1 0 0 1
refdes=U?
T 72200 47900 5 10 0 0 0 0 1
symversion=0.1
}
C 71900 46200 1 0 0 gnd-1.sym
C 62900 43400 1 270 0 3.3V-plus-1.sym
C 57200 43900 1 0 0 3.3V-plus-1.sym
C 56300 39800 1 90 0 3.3V-plus-1.sym
C 71800 47300 1 0 0 3.3V-plus-1.sym
C 71600 45000 1 90 0 resistor-1.sym
{
T 71200 45300 5 10 0 0 90 0 1
device=RESISTOR
T 71300 45200 5 10 1 1 90 0 1
refdes=R?
T 71600 45000 5 10 0 0 90 0 1
footprint=0603
}
N 71500 45900 71500 46700 4
C 72600 46000 1 180 0 resistor-1.sym
{
T 72300 45600 5 10 0 0 180 0 1
device=RESISTOR
T 72400 45700 5 10 1 1 180 0 1
refdes=R?
T 72600 46000 5 10 0 0 180 0 1
footprint=0603
}
N 71700 45900 71500 45900 4
N 72600 45900 72600 46900 4
N 72500 46900 73300 46900 4
{
T 73300 46900 5 10 1 1 0 0 1
netname=ISENSE1
}
C 72500 45900 1 270 0 resistor-1.sym
{
T 72900 45600 5 10 0 0 270 0 1
device=RESISTOR
T 72800 45700 5 10 1 1 270 0 1
refdes=R?
T 72500 45900 5 10 0 0 270 0 1
footprint=0603
}
C 71400 44700 1 0 0 gnd-1.sym
C 72500 44700 1 0 0 gnd-1.sym
N 71500 47100 69800 47100 4
N 67000 48100 69800 48100 4
{
T 67000 48100 5 10 1 1 0 0 1
netname=VBAT
}
N 67700 47500 67100 47500 4
{
T 66400 47500 5 10 1 1 0 0 1
netname=VSENSE1_EN
}
C 68300 46400 1 90 0 resistor-1.sym
{
T 67900 46700 5 10 0 0 90 0 1
device=RESISTOR
T 68000 46600 5 10 1 1 90 0 1
refdes=R?
T 68300 46400 5 10 0 0 90 0 1
footprint=0603
}
C 68300 45500 1 90 0 resistor-1.sym
{
T 67900 45800 5 10 0 0 90 0 1
device=RESISTOR
T 68000 45700 5 10 1 1 90 0 1
refdes=R?
T 68300 45500 5 10 0 0 90 0 1
footprint=0603
}
N 68200 46400 68800 46400 4
{
T 68400 46400 5 10 1 1 0 0 1
netname=VSENSE1
}
C 68100 45200 1 0 0 gnd-1.sym
N 69300 37900 67900 37900 4
T 70500 36800 9 10 1 0 0 0 2
Output: +3V to +9V
Optimize for +5V
C 68000 37000 1 90 0 resistor-1.sym
{
T 67600 37300 5 10 0 0 90 0 1
device=RESISTOR
T 67700 37200 5 10 1 1 90 0 1
refdes=R?
T 68000 37000 5 10 0 0 90 0 1
footprint=0603
}
C 68000 36100 1 90 0 resistor-1.sym
{
T 67600 36400 5 10 0 0 90 0 1
device=RESISTOR
T 67700 36300 5 10 1 1 90 0 1
refdes=R?
T 68000 36100 5 10 0 0 90 0 1
footprint=0603
}
N 67900 37000 68500 37000 4
{
T 68100 37000 5 10 1 1 0 0 1
netname=VSENSE2
}
C 67800 35800 1 0 0 gnd-1.sym
T 66100 45400 9 10 1 0 0 0 10
MOSFET to decouple
the voltage divider
when charger is not
active.

Finite resistance of
partially switched
FET should be small
compared to divider
resistance.
C 53500 48100 1 270 0 capacitor-2.sym
{
T 54200 47900 5 10 0 0 270 0 1
device=POLARIZED_CAPACITOR
T 54000 47900 5 10 1 1 270 0 1
refdes=C?
T 54400 47900 5 10 0 0 270 0 1
symversion=0.1
}
C 54800 47200 1 90 0 capacitor-1.sym
{
T 54100 47400 5 10 0 0 90 0 1
device=CAPACITOR
T 54300 47400 5 10 1 1 90 0 1
refdes=C?
T 53900 47400 5 10 0 0 90 0 1
symversion=0.1
}
C 53300 47200 1 90 0 capacitor-1.sym
{
T 52600 47400 5 10 0 0 90 0 1
device=CAPACITOR
T 52800 47400 5 10 1 1 90 0 1
refdes=C?
T 52400 47400 5 10 0 0 90 0 1
symversion=0.1
}
C 55600 47200 1 90 0 capacitor-1.sym
{
T 54900 47400 5 10 0 0 90 0 1
device=CAPACITOR
T 55100 47400 5 10 1 1 90 0 1
refdes=C?
T 54700 47400 5 10 0 0 90 0 1
symversion=0.1
}
C 54500 46900 1 0 0 gnd-1.sym
C 53300 46900 1 0 0 gnd-1.sym
N 53100 48100 53700 48100 4
N 53100 47200 53700 47200 4
C 55200 48100 1 0 0 3.3V-plus-1.sym
C 55300 46900 1 0 0 gnd-1.sym
C 61500 37800 1 0 1 gnd-1.sym
C 62000 38100 1 180 0 3.3V-plus-1.sym
N 56300 40800 55500 40800 4
{
T 54800 40700 5 10 1 1 0 0 1
netname=\_RESET\_
}
C 67700 47300 1 0 0 pmos-3.sym
{
T 68300 47800 5 10 0 0 0 0 1
device=PMOS_TRANSISTOR
T 68500 47800 5 10 1 1 90 0 1
refdes=Q?
}
C 58900 44200 1 180 1 gnd-1.sym
N 63300 50600 62900 50600 4
{
T 62500 50600 5 10 1 1 0 0 1
netname=VPANEL
}
C 64400 49500 1 90 0 zener-1.sym
{
T 63800 49900 5 10 0 0 90 0 1
device=ZENER_DIODE
T 63900 49800 5 10 1 1 90 0 1
refdes=Z?
T 64600 49800 5 10 1 1 90 0 1
value=15V
}
C 63300 50500 1 0 0 resistor-1.sym
{
T 63600 50900 5 10 0 0 0 0 1
device=RESISTOR
T 63500 50800 5 10 1 1 0 0 1
refdes=R?
T 63300 50500 5 10 0 0 0 0 1
footprint=0603
}
N 64200 50400 64200 50600 4
N 64700 50600 64200 50600 4
N 54400 50500 54800 50500 4
{
T 54900 50500 5 10 1 1 0 0 1
netname=VPANEL
}
N 58400 50600 58000 50600 4
{
T 57700 50600 5 10 1 1 0 0 1
netname=VPANEL
}
C 58400 50400 1 0 0 schottky-1.sym
{
T 58722 51072 5 10 0 0 0 0 1
device=DIODE
T 58700 50900 5 10 1 1 0 0 1
refdes=D?
T 58741 51232 5 10 0 1 0 0 1
footprint=SOD80
}
C 58400 49600 1 0 0 schottky-1.sym
{
T 58722 50272 5 10 0 0 0 0 1
device=DIODE
T 58700 50100 5 10 1 1 0 0 1
refdes=D?
T 58741 50432 5 10 0 1 0 0 1
footprint=SOD80
}
N 59300 50600 59300 49800 4
N 58400 49800 58000 49800 4
{
T 57700 49800 5 10 1 1 0 0 1
netname=VBATT
}
C 64700 50800 1 270 0 vcc-1.sym
N 53400 48100 53400 48400 4
{
T 53500 48500 5 10 1 1 90 0 1
netname=VPANEL
}
C 54400 48100 1 0 0 vcc-1.sym
C 67200 41100 1 0 0 vcc-1.sym
N 69000 41000 69000 41200 4
{
T 69100 41300 5 10 1 1 90 0 1
netname=VPANEL
}
N 69800 50300 69800 50500 4
{
T 69900 50600 5 10 1 1 90 0 1
netname=VPANEL
}
C 56400 47200 1 90 0 capacitor-1.sym
{
T 55700 47400 5 10 0 0 90 0 1
device=CAPACITOR
T 55900 47400 5 10 1 1 90 0 1
refdes=C?
T 55500 47400 5 10 0 0 90 0 1
symversion=0.1
}
N 56200 48400 56200 48100 4
{
T 56300 48500 5 10 1 1 90 0 1
netname=VBATT
}
C 56100 46900 1 0 0 gnd-1.sym
C 71300 39000 1 0 1 gnd-1.sym
N 72200 40000 72700 40000 4
{
T 72800 40000 5 10 1 1 0 0 1
netname=CH2_BATT_IN
}
N 72200 40400 72700 40400 4
{
T 72800 40400 5 10 1 1 0 0 1
netname=CH2_BATT_EN
}
C 71400 41100 1 0 1 vcc-1.sym
C 72300 39200 1 0 1 ucc27518.sym
{
T 70500 40900 5 10 1 1 0 0 1
refdes=U?
T 71400 40400 5 10 0 0 0 6 1
device=UCC27518
T 71400 40600 5 10 0 0 0 6 1
footprint=SOT89
}
C 70100 40200 1 0 1 pmos-3.sym
{
T 69500 40700 5 10 0 0 0 6 1
device=PMOS_TRANSISTOR
T 69700 40900 5 10 1 1 90 2 1
refdes=Q?
}
N 70100 40400 70200 40400 4
N 69600 41000 69600 41200 4
{
T 69700 41300 5 10 1 1 90 0 1
netname=VBATT
}
T 67200 34900 9 16 1 0 0 0 1
MCU-based solar battery charger
T 71100 34300 9 10 1 0 0 0 1
Ben Gamari
T 53000 43500 9 10 1 0 0 0 5
Note:
Small resistors should
be added to externally-
facing ADC inputs for
ESD protection
